@tailwind base;
@tailwind components;
@tailwind utilities;

/* LIGHT MODE */
:root {
  --button-outline: rgba(0,0,0, .10);
  --badge-outline: rgba(0,0,0, .05);

  /* Automatic computation of border around primary / danger buttons */
  --opaque-button-border-intensity: -8; /* In terms of percentages */

  /* Backgrounds applied on top of other backgrounds when hovered/active */
  --elevate-1: rgba(0,0,0, .03);
  --elevate-2: rgba(0,0,0, .08);

  --background: 0 0% 98%;

  --foreground: 220 15% 15%;

  --border: 0 0% 88%;

  --card: 0 0% 96%;

  --card-foreground: 220 15% 18%;

  --card-border: 0 0% 90%;

  --sidebar: 220 40% 15%;

  --sidebar-foreground: 0 0% 95%;

  --sidebar-border: 220 30% 20%;

  --sidebar-primary: 220 60% 25%;

  --sidebar-primary-foreground: 0 0% 98%;

  --sidebar-accent: 220 50% 30%;

  --sidebar-accent-foreground: 0 0% 98%;

  --sidebar-ring: 220 60% 40%;

  --popover: 0 0% 94%;

  --popover-foreground: 220 15% 20%;

  --popover-border: 0 0% 86%;

  --primary: 210 100% 50%;

  --primary-foreground: 0 0% 98%;

  --secondary: 0 0% 92%;

  --secondary-foreground: 220 15% 25%;

  --muted: 0 0% 93%;

  --muted-foreground: 0 0% 45%;

  --accent: 210 15% 90%;

  --accent-foreground: 220 15% 30%;

  --destructive: 0 70% 50%;

  --destructive-foreground: 0 0% 98%;

  --input: 0 0% 75%;
  --ring: 210 100% 50%;
  --chart-1: 120 60% 45%;
  --chart-2: 45 100% 55%;
  --chart-3: 210 100% 50%;
  --chart-4: 280 70% 50%;
  --chart-5: 30 80% 55%;

  --font-sans: Inter, sans-serif;
  --font-serif: Georgia, serif;
  --font-mono: Menlo, monospace;
  --radius: .5rem; /* 8px */
  --shadow-2xs: 0px 2px 0px 0px hsl(220 15% 85% / 0.15);
  --shadow-xs: 0px 2px 0px 0px hsl(220 15% 85% / 0.15);
  --shadow-sm: 0px 2px 0px 0px hsl(220 15% 85% / 0.15), 0px 1px 2px -1px hsl(220 15% 75% / 0.20);
  --shadow: 0px 2px 0px 0px hsl(220 15% 85% / 0.15), 0px 1px 2px -1px hsl(220 15% 75% / 0.20);
  --shadow-md: 0px 2px 0px 0px hsl(220 15% 85% / 0.15), 0px 2px 4px -1px hsl(220 15% 75% / 0.25);
  --shadow-lg: 0px 2px 0px 0px hsl(220 15% 85% / 0.15), 0px 4px 6px -1px hsl(220 15% 75% / 0.30);
  --shadow-xl: 0px 2px 0px 0px hsl(220 15% 85% / 0.15), 0px 8px 10px -1px hsl(220 15% 75% / 0.35);
  --shadow-2xl: 0px 2px 0px 0px hsl(220 15% 85% / 0.20);
  --tracking-normal: 0em;
  --spacing: 0.25rem;

  /* TV Display Responsive Tokens - Auto-scale based on viewport size */
  /* Using vmin (smallest viewport dimension) for consistent scaling across screen sizes */
  
  /* Overscan safe padding for TV displays - 4vmin for proper 3-5% safety margin */
  --tv-overscan: clamp(16px, 4vmin, 96px);
  
  /* Responsive font sizes - auto-adapt from 600px to 4K displays */
  /* Using vw units for width-based scaling - better for landscape TVs */
  --tv-fs-xs: clamp(6px, 1vw, 14px);
  --tv-fs-sm: clamp(8px, 1.2vw, 18px);
  --tv-fs-md: clamp(10px, 1.5vw, 24px);
  --tv-fs-lg: clamp(12px, 2vw, 32px);
  --tv-fs-xl: clamp(14px, 2.5vw, 48px);
  --tv-fs-2xl: clamp(16px, 3vw, 64px);
  --tv-fs-3xl: clamp(18px, 4vw, 90px);
  --tv-fs-4xl: clamp(22px, 5vw, 120px);
  --tv-fs-5xl: clamp(26px, 6vw, 160px);
  
  /* TV-specific spacing - scales with screen */
  --tv-gap-xs: clamp(2px, 0.5vmin, 8px);
  --tv-gap-sm: clamp(4px, 1.0vmin, 16px);
  --tv-gap-md: clamp(6px, 1.5vmin, 24px);
  --tv-gap-lg: clamp(8px, 2.0vmin, 32px);
  --tv-gap-xl: clamp(12px, 3.0vmin, 48px);
  
  /* TV border radius - scales proportionally */
  --tv-radius: clamp(8px, 1.0vmin, 24px);

  /* Automatically computed borders - intensity can be controlled by the user by the --opaque-button-border-intensity setting */

  /* Fallback for older browsers */
  --sidebar-primary-border: hsl(var(--sidebar-primary));
  --sidebar-primary-border: hsl(from hsl(var(--sidebar-primary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);

  /* Fallback for older browsers */
  --sidebar-accent-border: hsl(var(--sidebar-accent));
  --sidebar-accent-border: hsl(from hsl(var(--sidebar-accent)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);

  /* Fallback for older browsers */
  --primary-border: hsl(var(--primary));
  --primary-border: hsl(from hsl(var(--primary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);

  /* Fallback for older browsers */
  --secondary-border: hsl(var(--secondary));
  --secondary-border: hsl(from hsl(var(--secondary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);

  /* Fallback for older browsers */
  --muted-border: hsl(var(--muted));
  --muted-border: hsl(from hsl(var(--muted)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);

  /* Fallback for older browsers */
  --accent-border: hsl(var(--accent));
  --accent-border: hsl(from hsl(var(--accent)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);

  /* Fallback for older browsers */
  --destructive-border: hsl(var(--destructive));
  --destructive-border: hsl(from hsl(var(--destructive)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);
}

.dark {
  --button-outline: rgba(255,255,255, .10);
  --badge-outline: rgba(255,255,255, .05);

  --opaque-button-border-intensity: 9;  /* In terms of percentages */

  /* Backgrounds applied on top of other backgrounds when hovered/active */
  --elevate-1: rgba(255,255,255, .04);
  --elevate-2: rgba(255,255,255, .09);

  --background: 220 15% 12%;

  --foreground: 0 0% 92%;

  --border: 220 15% 20%;

  --card: 220 15% 15%;

  --card-foreground: 0 0% 90%;

  --card-border: 220 15% 22%;

  --sidebar: 220 15% 8%;

  --sidebar-foreground: 0 0% 90%;

  --sidebar-border: 220 15% 18%;

  --sidebar-primary: 210 90% 35%;

  --sidebar-primary-foreground: 0 0% 95%;

  --sidebar-accent: 220 15% 18%;

  --sidebar-accent-foreground: 0 0% 85%;

  --sidebar-ring: 210 90% 40%;

  --popover: 220 15% 18%;

  --popover-foreground: 0 0% 88%;

  --popover-border: 220 15% 25%;

  --primary: 210 90% 35%;

  --primary-foreground: 0 0% 95%;

  --secondary: 220 15% 20%;

  --secondary-foreground: 0 0% 85%;

  --muted: 220 15% 17%;

  --muted-foreground: 0 0% 65%;

  --accent: 220 12% 19%;

  --accent-foreground: 0 0% 80%;

  --destructive: 0 70% 40%;

  --destructive-foreground: 0 0% 95%;

  /* Used as the border around inputs. Dark mode: Should be a border that is light enough to have high contrast when rendered on a --card background. More contrast than standard --border */
  --input: 220 15% 35%;
  --ring: 210 90% 40%;
  --chart-1: 120 60% 65%;
  --chart-2: 45 100% 70%;
  --chart-3: 210 90% 60%;
  --chart-4: 280 70% 70%;
  --chart-5: 30 80% 70%;

  --shadow-2xs: 0px 2px 0px 0px hsl(220 20% 8% / 0.30);
  --shadow-xs: 0px 2px 0px 0px hsl(220 20% 8% / 0.30);
  --shadow-sm: 0px 2px 0px 0px hsl(220 20% 8% / 0.30), 0px 1px 2px -1px hsl(220 20% 5% / 0.40);
  --shadow: 0px 2px 0px 0px hsl(220 20% 8% / 0.30), 0px 1px 2px -1px hsl(220 20% 5% / 0.40);
  --shadow-md: 0px 2px 0px 0px hsl(220 20% 8% / 0.30), 0px 2px 4px -1px hsl(220 20% 5% / 0.50);
  --shadow-lg: 0px 2px 0px 0px hsl(220 20% 8% / 0.30), 0px 4px 6px -1px hsl(220 20% 5% / 0.60);
  --shadow-xl: 0px 2px 0px 0px hsl(220 20% 8% / 0.30), 0px 8px 10px -1px hsl(220 20% 5% / 0.70);
  --shadow-2xl: 0px 2px 0px 0px hsl(220 20% 8% / 0.40);

}

/* 16:9 Letterbox Fallback for older browsers/TVs that don't support aspect-ratio */
@supports not (aspect-ratio: 16 / 9) {
  [data-testid="tv-display"] {
    position: relative !important;
    width: min(100vw, 177.78vh) !important;
    height: calc((min(100vw, 177.78vh)) * 9 / 16) !important;
  }
}

@layer base {
  * {
    @apply border-border;
  }

  body {
    @apply font-sans antialiased bg-background text-foreground;
  }
}

/**
 * Using the elevate system.
 * Automatic contrast adjustment.
 *
 * <element className="hover-elevate" />
 * <element className="active-elevate-2" />
 *
 * // Using the tailwind utility when a data attribute is "on"
 * <element className="toggle-elevate data-[state=on]:toggle-elevated" />
 * // Or manually controlling the toggle state
 * <element className="toggle-elevate toggle-elevated" />
 *
 * Elevation systems have to handle many states.
 * - not-hovered, vs. hovered vs. active  (three mutually exclusive states)
 * - toggled or not
 * - focused or not (this is not handled with these utilities)
 *
 * Even without handling focused or not, this is six possible combinations that
 * need to be distinguished from eachother visually.
 */
@layer utilities {

  /* Hide ugly search cancel button in Chrome until we can style it properly */
  input[type="search"]::-webkit-search-cancel-button {
    @apply hidden;
  }

  /* Placeholder styling for contentEditable div */
  [contenteditable][data-placeholder]:empty::before {
    content: attr(data-placeholder);
    color: hsl(var(--muted-foreground));
    pointer-events: none;
  }

  /* .no-default-hover-elevate/no-default-active-elevate is an escape hatch so consumers of
   * buttons/badges can remove the automatic brightness adjustment on interactions
   * and program their own. */
  .no-default-hover-elevate {}

  .no-default-active-elevate {}


  /**
   * Toggleable backgrounds go behind the content. Hoverable/active goes on top.
   * This way they can stack/compound. Both will overlap the parent's borders!
   * So borders will be automatically adjusted both on toggle, and hover/active,
   * and they will be compounded.
   */
  .toggle-elevate::before,
  .toggle-elevate-2::before {
    content: "";
    pointer-events: none;
    position: absolute;
    inset: 0px;
    /*border-radius: inherit;   match rounded corners */
    border-radius: inherit;
    z-index: -1;
    /* sits behind content but above backdrop */
  }

  .toggle-elevate.toggle-elevated::before {
    background-color: var(--elevate-2);
  }

  /* If there's a 1px border, adjust the inset so that it covers that parent's border */
  .border.toggle-elevate::before {
    inset: -1px;
  }

  /* Does not work on elements with overflow:hidden! */
  .hover-elevate:not(.no-default-hover-elevate),
  .active-elevate:not(.no-default-active-elevate),
  .hover-elevate-2:not(.no-default-hover-elevate),
  .active-elevate-2:not(.no-default-active-elevate) {
    position: relative;
    z-index: 0;
  }

  .hover-elevate:not(.no-default-hover-elevate)::after,
  .active-elevate:not(.no-default-active-elevate)::after,
  .hover-elevate-2:not(.no-default-hover-elevate)::after,
  .active-elevate-2:not(.no-default-active-elevate)::after {
    content: "";
    pointer-events: none;
    position: absolute;
    inset: 0px;
    /*border-radius: inherit;   match rounded corners */
    border-radius: inherit;
    z-index: 999;
    /* sits in front of content */
  }

  .hover-elevate:hover:not(.no-default-hover-elevate)::after,
  .active-elevate:active:not(.no-default-active-elevate)::after {
    background-color: var(--elevate-1);
  }

  .hover-elevate-2:hover:not(.no-default-hover-elevate)::after,
  .active-elevate-2:active:not(.no-default-active-elevate)::after {
    background-color: var(--elevate-2);
  }

  /* If there's a 1px border, adjust the inset so that it covers that parent's border */
  .border.hover-elevate:not(.no-hover-interaction-elevate)::after,
  .border.active-elevate:not(.no-active-interaction-elevate)::after,
  .border.hover-elevate-2:not(.no-hover-interaction-elevate)::after,
  .border.active-elevate-2:not(.no-active-interaction-elevate)::after,
  .border.hover-elevate:not(.no-hover-interaction-elevate)::after {
    inset: -1px;
  }

  /* Marquee animation for TV display */
  @keyframes marquee {
    0% {
      transform: translateX(100%);
    }
    100% {
      transform: translateX(-100%);
    }
  }

  .animate-marquee {
    animation: marquee 25s linear infinite;
  }

  /* Custom Sidebar Gradient - Force Override */
  .sidebar-gradient {
    background: linear-gradient(180deg, #2980b9 0%, #1f4e79 30%, #1a252f 70%, #0d1821 100%) !important;
  }

  /* Override Shadcn Sidebar default background */
  .bg-sidebar {
    background: linear-gradient(180deg, #2980b9 0%, #1f4e79 30%, #1a252f 70%, #0d1821 100%) !important;
  }

  .sidebar-section-header {
    color: rgba(148, 163, 184, 0.7);
    font-size: 0.75rem;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    margin-bottom: 0.5rem;
    margin-top: 1.5rem;
  }

  .sidebar-section-header:first-child {
    margin-top: 0;
  }

  /* Gradient Button Styling */
  .btn-gradient {
    background: linear-gradient(135deg, #2980b9 0%, #1f4e79 50%, #1a252f 100%) !important;
    border: 1px solid #1f4e79 !important;
    color: white !important;
    transition: all 0.3s ease !important;
  }

  .btn-gradient:hover {
    background: linear-gradient(135deg, #3498db 0%, #2980b9 50%, #1f4e79 100%) !important;
    transform: translateY(-1px) !important;
    box-shadow: 0 4px 8px rgba(41, 128, 185, 0.3) !important;
  }

  /* Enhanced Sidebar Navigation Styling */
  .sidebar-nav-item {
    transition: all 0.3s ease !important;
    border-radius: 8px !important;
    margin: 2px 0 !important;
  }

  .sidebar-nav-item:hover {
    background: linear-gradient(90deg, rgba(52, 152, 219, 0.15) 0%, rgba(41, 128, 185, 0.1) 100%) !important;
    transform: translateX(4px) !important;
    box-shadow: 0 2px 8px rgba(52, 152, 219, 0.2) !important;
    border-left: 3px solid #3498db !important;
  }

  .sidebar-nav-item[data-active="true"] {
    background: linear-gradient(90deg, rgba(52, 152, 219, 0.25) 0%, rgba(41, 128, 185, 0.15) 100%) !important;
    border-left: 3px solid #3498db !important;
    box-shadow: 0 2px 12px rgba(52, 152, 219, 0.3) !important;
  }

  .sidebar-nav-item[data-active="true"]:hover {
    background: linear-gradient(90deg, rgba(52, 152, 219, 0.3) 0%, rgba(41, 128, 185, 0.2) 100%) !important;
    transform: translateX(6px) !important;
  }

  /* Sidebar text enhancements */
  .sidebar-nav-item .sidebar-nav-text {
    color: rgba(255, 255, 255, 0.9) !important;
    transition: color 0.3s ease !important;
  }

  .sidebar-nav-item:hover .sidebar-nav-text {
    color: rgba(255, 255, 255, 1) !important;
  }

  .sidebar-nav-item[data-active="true"] .sidebar-nav-text {
    color: rgba(255, 255, 255, 1) !important;
    font-weight: 600 !important;
  }

  /* Circular Color Picker Styling - Professional Look */
  input[type="color"] {
    width: 50px !important;
    height: 50px !important;
    border-radius: 50% !important;
    border: 3px solid hsl(var(--border)) !important;
    cursor: pointer !important;
    padding: 0 !important;
    background: none !important;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1) !important;
    transition: all 0.2s ease !important;
  }

  input[type="color"]:hover {
    transform: scale(1.05) !important;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15) !important;
  }

  input[type="color"]:focus {
    outline: none !important;
    transform: scale(1.1) !important;
    box-shadow: 0 0 0 3px hsl(var(--primary) / 0.2) !important;
  }

  /* Remove default webkit appearance */
  input[type="color"]::-webkit-color-swatch-wrapper {
    padding: 0 !important;
    border-radius: 50% !important;
    border: none !important;
  }

  input[type="color"]::-webkit-color-swatch {
    border-radius: 50% !important;
    border: none !important;
  }

  /* Firefox color input styling */
  input[type="color"]::-moz-color-swatch {
    border-radius: 50% !important;
    border: none !important;
  }

  /* Small circular color picker variant */
  .color-picker-small {
    width: 32px !important;
    height: 32px !important;
    border-width: 2px !important;
  }

  /* Large circular color picker variant */
  .color-picker-large {
    width: 60px !important;
    height: 60px !important;
    border-width: 4px !important;
  }

  /* ============================================ */
  /* TV Display Responsive Media Queries */
  /* Fine-tune sizing for different TV resolutions */
  /* ============================================ */

  /* Extra Small Screens - 720p and below (1280x720) */
  @media (max-width: 1366px) {
    :root {
      --tv-fs-xs: clamp(7px, 1.2vw, 16px);
      --tv-fs-sm: clamp(9px, 1.4vw, 20px);
      --tv-fs-md: clamp(11px, 1.8vw, 26px);
      --tv-fs-lg: clamp(14px, 2.4vw, 36px);
      --tv-fs-xl: clamp(16px, 3vw, 52px);
      --tv-fs-2xl: clamp(18px, 3.6vw, 68px);
      --tv-fs-3xl: clamp(20px, 4.8vw, 96px);
      --tv-fs-4xl: clamp(24px, 6vw, 128px);
      --tv-fs-5xl: clamp(28px, 7.2vw, 168px);
    }
  }

  /* Standard HD - 1080p (1920x1080) */
  @media (min-width: 1367px) and (max-width: 1920px) {
    :root {
      --tv-fs-xs: clamp(8px, 1vw, 16px);
      --tv-fs-sm: clamp(10px, 1.2vw, 20px);
      --tv-fs-md: clamp(12px, 1.5vw, 26px);
      --tv-fs-lg: clamp(14px, 2vw, 36px);
      --tv-fs-xl: clamp(16px, 2.5vw, 52px);
      --tv-fs-2xl: clamp(18px, 3vw, 68px);
      --tv-fs-3xl: clamp(20px, 4vw, 96px);
      --tv-fs-4xl: clamp(24px, 5vw, 128px);
      --tv-fs-5xl: clamp(28px, 6vw, 168px);
    }
  }

  /* 2K/QHD - (2560x1440) */
  @media (min-width: 1921px) and (max-width: 2560px) {
    :root {
      --tv-fs-xs: clamp(10px, 0.9vw, 18px);
      --tv-fs-sm: clamp(12px, 1.1vw, 22px);
      --tv-fs-md: clamp(14px, 1.4vw, 28px);
      --tv-fs-lg: clamp(16px, 1.8vw, 38px);
      --tv-fs-xl: clamp(18px, 2.2vw, 54px);
      --tv-fs-2xl: clamp(20px, 2.8vw, 72px);
      --tv-fs-3xl: clamp(24px, 3.6vw, 100px);
      --tv-fs-4xl: clamp(28px, 4.5vw, 132px);
      --tv-fs-5xl: clamp(32px, 5.4vw, 176px);
    }
  }

  /* 4K/UHD - (3840x2160) and above */
  @media (min-width: 2561px) {
    :root {
      --tv-fs-xs: clamp(12px, 0.7vw, 20px);
      --tv-fs-sm: clamp(14px, 0.9vw, 24px);
      --tv-fs-md: clamp(16px, 1.1vw, 30px);
      --tv-fs-lg: clamp(18px, 1.4vw, 40px);
      --tv-fs-xl: clamp(20px, 1.7vw, 56px);
      --tv-fs-2xl: clamp(24px, 2.2vw, 76px);
      --tv-fs-3xl: clamp(28px, 2.8vw, 104px);
      --tv-fs-4xl: clamp(32px, 3.5vw, 136px);
      --tv-fs-5xl: clamp(36px, 4.2vw, 180px);
    }
  }

  /* Portrait/Vertical Displays - Adjust for vertical orientation */
  @media (orientation: portrait) {
    :root {
      /* Use vh instead of vw for portrait mode */
      --tv-fs-xs: clamp(6px, 1vh, 14px);
      --tv-fs-sm: clamp(8px, 1.2vh, 18px);
      --tv-fs-md: clamp(10px, 1.5vh, 24px);
      --tv-fs-lg: clamp(12px, 2vh, 32px);
      --tv-fs-xl: clamp(14px, 2.5vh, 48px);
      --tv-fs-2xl: clamp(16px, 3vh, 64px);
      --tv-fs-3xl: clamp(18px, 4vh, 90px);
      --tv-fs-4xl: clamp(22px, 5vh, 120px);
      --tv-fs-5xl: clamp(26px, 6vh, 160px);
    }
  }

  /* ============================================ */
  /* FINAL FIX: 16:9 SAFE BOX - Content muat sepenuhnya, tiada potong/scroll */
  /* ============================================ */

  /* TV Frame - Outer wrapper centers the 16:9 box */
  .tv-frame {
    height: 100vh;
    width: 100vw;
    display: grid;
    place-items: center;
    background: #000;           /* Black letterbox borders */
    overflow: hidden;           /* No scrollbars */
  }

  /* TV Content - SAFE 16:9 BOX yang scales to fit screen */
  .tv-content {
    aspect-ratio: 16 / 9;
    width: min(100vw, 177.78vh);    /* Fit dalam screen, maintain 16:9 */
    height: auto;
    overflow: hidden;                /* Prevent inner content overflow */
    display: flex;
    flex-direction: column;
    /* Allow shrinking */
    min-width: 0;
    min-height: 0;
  }

  /* Fallback untuk browsers tanpa aspect-ratio support */
  @supports not (aspect-ratio: 16 / 9) {
    .tv-content {
      width: min(100vw, 177.78vh);
      height: calc((min(100vw, 177.78vh)) * 9 / 16);
    }
  }

  /* Grid utama dalam 16:9 box - MESTI height: 100% */
  .tv-grid {
    height: 100%;               /* Wajib: guna penuh safe box */
    width: 100%;
    display: grid;
    gap: 0;
    /* Allow children to shrink */
    min-height: 0;
    min-width: 0;
  }

  /* All sections dalam grid kena boleh shrink */
  .tv-left, .tv-right, .tv-section {
    min-height: 0;
    min-width: 0;
    overflow: hidden;           /* Prevent overflow */
  }

  /* Images dalam TV - WAJIB object-fit */
  .tv-content img,
  .tv-content video,
  .tv-content iframe {
    width: 100%;
    height: 100%;
    object-fit: cover;          /* atau 'contain' jika tak mahu crop */
    display: block;
  }

  /* Teks skala ikut safe box (bukan device) */
  .tv-content h1 {
    margin: 0 0 1%;
    font-size: clamp(24px, 4.2vw, 72px);
    line-height: 1.1;
  }
}