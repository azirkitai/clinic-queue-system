<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1" />
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
    <meta http-equiv="Pragma" content="no-cache" />
    <meta http-equiv="Expires" content="0" />
    <title>Sistem Panggilan Klinik - Clinic Calling System</title>
    <meta name="description" content="Sistem panggilan pesakit untuk klinik dengan paparan TV real-time, pengurusan queue, dan pentadbiran berbilang pengguna." />
    <link rel="icon" type="image/png" href="/favicon.png" />
    <link rel="apple-touch-icon" href="/favicon.png" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&display=swap" rel="stylesheet">
  </head>
  <body>
    <div id="root"></div>
    <script type="module" src="/src/main.tsx"></script>
    <script nomodule>
      document.getElementById('root').innerHTML = '<div style="display:flex;align-items:center;justify-content:center;min-height:100vh;font-family:sans-serif;background:#f0f4ff;padding:20px"><div style="text-align:center;max-width:500px"><h1 style="font-size:24px;color:#1e40af;margin-bottom:16px">Browser Tidak Disokong</h1><p style="color:#666;font-size:16px;line-height:1.6">Browser ini terlalu lama untuk menjalankan sistem paparan TV.<br><br>Sila gunakan browser yang lebih baru seperti:<br><b>Chrome 64+</b>, <b>Firefox 67+</b>, atau <b>Samsung Internet 9.2+</b></p><p style="color:#999;font-size:13px;margin-top:20px">Jika menggunakan Android TV dongle, sila pasang aplikasi browser terkini dari Play Store.</p></div></div>';
    </script>
    <noscript>
      <div style="display:flex;align-items:center;justify-content:center;min-height:100vh;font-family:sans-serif;background:#f0f4ff;padding:20px">
        <div style="text-align:center;max-width:500px">
          <h1 style="font-size:24px;color:#1e40af;margin-bottom:16px">JavaScript Diperlukan</h1>
          <p style="color:#666;font-size:16px">Sila aktifkan JavaScript dalam tetapan browser anda untuk menggunakan paparan TV klinik.</p>
        </div>
      </div>
    </noscript>
    <!-- Standalone version check - runs independently of React -->
    <script>
      (function() {
        var STORAGE_KEY = 'clinic-html-version';
        var CHECK_INTERVAL = 60000; // Check every 1 minute
        var storedVersion = localStorage.getItem(STORAGE_KEY);
        
        function checkVersion() {
          fetch('/api/version', { cache: 'no-store' })
            .then(function(r) { return r.json(); })
            .then(function(data) {
              var currentVersion = data.version;
              if (storedVersion && storedVersion !== currentVersion) {
                console.log('[HTML] New version detected, reloading...');
                localStorage.setItem(STORAGE_KEY, currentVersion);
                setTimeout(function() {
                  window.location.reload(true);
                }, Math.random() * 5000);
              } else if (!storedVersion) {
                localStorage.setItem(STORAGE_KEY, currentVersion);
              }
              storedVersion = currentVersion;
            })
            .catch(function() {});
        }
        
        // Check immediately and then every minute
        setTimeout(checkVersion, 3000);
        setInterval(checkVersion, CHECK_INTERVAL);
      })();
    </script>
  </body>
</html>